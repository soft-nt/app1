---
phase: 05-project-setup-environment
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .env.local
  - src/vite-env.d.ts
  - src/types/weather.ts
autonomous: true
user_setup:
  - service: openweathermap
    why: "Weather data API for displaying current conditions"
    env_vars:
      - name: VITE_OPENWEATHER_API_KEY
        source: "OpenWeatherMap Dashboard -> API keys (https://home.openweathermap.org/api_keys)"
    account_setup:
      - "Create free account at openweathermap.org"
      - "Note: API key takes ~2 hours to activate after creation"

must_haves:
  truths:
    - "Developer can access import.meta.env.VITE_OPENWEATHER_API_KEY with TypeScript autocomplete"
    - "TypeScript interfaces exist for WeatherData and WeatherCondition types"
    - "npm run dev works without TypeScript errors"
  artifacts:
    - path: ".env.local"
      provides: "OpenWeatherMap API key storage"
      contains: "VITE_OPENWEATHER_API_KEY"
    - path: "src/vite-env.d.ts"
      provides: "Type-safe environment variable access"
      contains: "VITE_OPENWEATHER_API_KEY"
    - path: "src/types/weather.ts"
      provides: "TypeScript interfaces for OpenWeatherMap API response"
      exports: ["WeatherData", "WeatherCondition"]
  key_links:
    - from: "src/vite-env.d.ts"
      to: "import.meta.env"
      via: "ImportMetaEnv interface extension"
      pattern: "interface ImportMetaEnv"
    - from: "src/types/weather.ts"
      to: "OpenWeatherMap Current Weather API"
      via: "Interface matching API response structure"
      pattern: "export interface WeatherData"
---

<objective>
Configure project for OpenWeatherMap API integration with environment variables and TypeScript type safety.

Purpose: Enable type-safe weather data fetching in future phases by establishing environment configuration and API response types now.
Output: .env.local for API key storage, extended vite-env.d.ts for type-safe env access, weather.ts with API response interfaces.
</objective>

<execution_context>
@/home/ntorrent/.claude/get-shit-done/workflows/execute-plan.md
@/home/ntorrent/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/05-project-setup-&-environment/05-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create environment variable configuration</name>
  <files>.env.local, src/vite-env.d.ts</files>
  <action>
1. Create `.env.local` in project root with placeholder API key:
```
# OpenWeatherMap API key - get yours at https://home.openweathermap.org/api_keys
# Note: New keys take ~2 hours to activate after creation
VITE_OPENWEATHER_API_KEY=your_api_key_here
```

2. Create `src/vite-env.d.ts` to extend Vite's ImportMetaEnv interface:
```typescript
/// <reference types="vite/client" />

interface ImportMetaEnv {
  readonly VITE_OPENWEATHER_API_KEY: string
}

interface ImportMeta {
  readonly env: ImportMetaEnv
}
```

WHY: Vite only exposes variables with VITE_ prefix to client code. The ImportMetaEnv extension enables TypeScript autocomplete and type checking for environment variables.
  </action>
  <verify>
- `.env.local` exists in project root
- `src/vite-env.d.ts` exists with ImportMetaEnv interface
- `npm run build` completes without TypeScript errors
  </verify>
  <done>Environment variables configured with type-safe access via import.meta.env.VITE_OPENWEATHER_API_KEY</done>
</task>

<task type="auto">
  <name>Task 2: Create TypeScript interfaces for weather API</name>
  <files>src/types/weather.ts</files>
  <action>
Create `src/types/weather.ts` with interfaces matching OpenWeatherMap Current Weather API response (https://openweathermap.org/current):

```typescript
// OpenWeatherMap Current Weather API response types
// Source: https://openweathermap.org/current

export interface WeatherCondition {
  id: number
  main: string
  description: string
  icon: string
}

export interface MainWeatherData {
  temp: number
  feels_like: number
  temp_min: number
  temp_max: number
  pressure: number
  humidity: number
}

export interface Wind {
  speed: number
  deg: number
  gust?: number  // Optional - only present when gusty
}

export interface Clouds {
  all: number
}

export interface Sys {
  type?: number
  id?: number
  country: string
  sunrise: number
  sunset: number
}

export interface Coord {
  lon: number
  lat: number
}

export interface WeatherData {
  coord: Coord
  weather: WeatherCondition[]
  base: string
  main: MainWeatherData
  visibility: number
  wind: Wind
  clouds: Clouds
  dt: number
  sys: Sys
  timezone: number
  id: number
  name: string
  cod: number
}
```

WHY: Defining interfaces upfront ensures type safety throughout the application. Optional fields (gust, type, id) marked with ? to handle variable API responses.
  </action>
  <verify>
- `src/types/weather.ts` exists
- File exports WeatherData and WeatherCondition interfaces
- `npm run build` completes without TypeScript errors
  </verify>
  <done>TypeScript interfaces defined for complete OpenWeatherMap Current Weather API response structure</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `npm run build` passes (TypeScript compilation succeeds)
2. `.env.local` exists and is git-ignored (verify with `git status`)
3. Types can be imported: create a test import in any file to verify `import type { WeatherData } from './types/weather'` resolves
</verification>

<success_criteria>
- API-02 satisfied: API key stored in environment variable (.env.local)
- API-05 satisfied: TypeScript types defined for API response (WeatherData, WeatherCondition)
- Developer can run project with `npm run dev` without errors
- Type safety enforced via ImportMetaEnv extension and weather.ts interfaces
</success_criteria>

<output>
After completion, create `.planning/phases/05-project-setup-&-environment/05-01-SUMMARY.md`
</output>
